<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:camel="http://camel.apache.org/schema/spring"
       xmlns:scala-util="http://www.springframework.org/schema/scala/util"
       xsi:schemaLocation="
		http://www.springframework.org/schema/util  http://www.springframework.org/schema/util/spring-util-3.0.xsd
	    http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd
        http://www.springframework.org/schema/scala/util http://www.springframework.org/schema/scala/util/scala-util.xsd">


    <bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location" value="file:src/test/resources/com.tactix4.t4ADT.properties"/>
    </bean>

    <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
        <property name="driverClassName" value="org.postgresql.Driver"/>
        <property name="url" value="jdbc:postgresql://localhost:5740/t4skr"/>
        <property name="username" value="max"/>
        <property name="password" value="max"/>
    </bean>

    <bean id="sql" class="org.apache.camel.component.sql.SqlComponent">
        <property name="dataSource" ref="dataSource"/>
    </bean>
    <bean class="org.springframework.beans.factory.config.CustomEditorConfigurer">
        <property name="propertyEditorRegistrars">
            <bean class="org.springframework.scala.beans.propertyeditors.ScalaEditorRegistrar"/>
        </property>
    </bean>

    <bean id="hl7codec" class="org.apache.camel.component.hl7.HL7MLLPCodec"/>


    <camel:endpoint id="rabbitMQSuccess" uri="mock:rabbitMQSuccess"/>
    <camel:endpoint id="rabbitMQFail" uri="mock:rabbitMQFail"/>

    <camel:endpoint id="hl7listener" uri="mina2:tcp://localhost:8888?sync=true&amp;codec=#hl7codec"/>


    <bean id="a01map" class="com.tactix4.t4ADT.utils.SpringHelper" factory-method="propertiesToMap">
        <constructor-arg>
            <util:properties location="classpath:ADT_A01.properties"/>
        </constructor-arg>
    </bean>

    <bean id="a31map" class="com.tactix4.t4ADT.utils.SpringHelper" factory-method="propertiesToMap">
        <constructor-arg>
            <util:properties location="classpath:ADT_A31.properties"/>
        </constructor-arg>
    </bean>

    <bean id="a40map" class="com.tactix4.t4ADT.utils.SpringHelper" factory-method="propertiesToMap">
        <constructor-arg>
            <util:properties location="classpath:ADT_A40.properties"/>
        </constructor-arg>
    </bean>
    <bean id="mockOpenERP" class="com.tactix4.t4ADT.OpenERPMock"/>

 <bean id="adtInRoute" class="com.tactix4.t4ADT.ADTInRoute">
        <constructor-arg name="terserMap">
            <scala-util:map>
                <entry key="A01" value-ref="a01map"/>
                <entry key="A28" value-ref="a01map"/>
                <entry key="A05" value-ref="a01map"/>
                <entry key="A31" value-ref="a31map"/>
                <entry key="A08" value-ref="a01map"/>
                <entry key="A03" value-ref="a01map"/>
                <entry key="A40" value-ref="a40map"/>
            </scala-util:map>
        </constructor-arg>
        <constructor-arg name="protocol" value="${protocol}"/>
        <constructor-arg name="host" value="${hostname}"/>
        <constructor-arg name="port" value="${port}"/>
        <constructor-arg name="username" value="${username}"/>
        <constructor-arg name="password" value="${password}"/>
        <constructor-arg name="database" value="${database}"/>
        <constructor-arg name="fromDateFormat" value="${fromDateFormat}"/>
        <constructor-arg name="toDateFormat" value="${toDateFormat}"/>
        <constructor-arg name="timeOutMillis" value="${timeOutMillis}"/>
        <constructor-arg name="maximumRedeliveries" value="${maximumRedeliveries}"/>
        <constructor-arg name="redeliveryDelay" value="${redeliveryDelay}"/>
    </bean>


    <camel:camelContext id="camel">
        <camel:routeBuilder ref="adtInRoute"/>
    </camel:camelContext>


</beans>
